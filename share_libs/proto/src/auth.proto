syntax = "proto3";

enum Ret {
    Ok = 0;
    Dup = 1;
    OutOfTime = 2;
    BadSig = 3;
}

message VerifyReqMsg {
    string nonce = 1;
    uint64 valid_until_block = 2;
    bytes hash = 3;
    bytes signature = 4;
    bytes tx_hash = 5;
}

message VerifyReq {
    repeated VerifyReqMsg reqs = 1;
}

message VerifyRespMsg {
    bytes tx_hash = 1;
    Ret ret = 2;
    bytes signer = 3; //public key
}

message VerifyResp {
    repeated VerifyRespMsg resps = 1;
}


